<% if @messages && @current_user.subscriber? %>
<div class="row">
	<div class="small-6 columns">
		&nbsp;
	</div><!--/.small-6-->
	<div class="small-6 columns text-right profile-tabs">
		<h2 class="active" id="tab-conversation">conversation</h3>
		<h2 id="tab-profile">profile</h3>
	</div><!--/.small-6-->
</div><!--/.row-->
<% end %>

<div id="profile-conversation-wrapper">
	<div id="profile-conversation">
	<%= render partial: "matches/conversation", locals: {profile: profile} %>
	</div>
</div>

<div class="row profile-logo">
	<div class="medium-4 columns medium-push-8 medium-text-right">
		<% if profile.logo_file_name %>
			<%= image_tag profile.logo.url(:medium), alt: "Logo" %>
		<% else %>
			<% if !profile.facebook.blank? && fb_picture(profile.facebook) %>
				<%= image_tag fb_picture(profile.facebook) %>
			<% else %>
				<%= image_tag profile.logo.url(:medium), width: "100", height: "100", alt: "Logo" %>
			<% end %>					
		<% end %>
	</div><!--/.medium-4-->
	<div class="medium-8 columns medium-pull-4 medium-text-left">
		<h1><%= profile.company_name %></h1>

		<div>
			<% profile.tags.each do |tag| %>
				<span data-tooltip aria-haspopup="true" class="has-tip radius tip-right" title="GLOBAL GOOD TAGS"><span class="tag"><%= tag.name %></span></span>
			<% end %>
		</div>
		
		<% if profile.class.to_s == "Brand" && !profile.trends.blank? %>
		<div>
			<% profile.trends.pluck(:name).each do |trend| %>
				<span data-tooltip aria-haspopup="true" class="has-tip radius tip-right" title="TRENDS"><span class="tag trend"><%= trend %></span></span>
			<% end %>
		</div>				
		<% end %>
		
		<br>

		<div class="profile-general-info">
			<div class="data">
				Based in 
				<strong>
				<% if profile.country_of_origin.blank? %>
				 Unknown Country
				<% else %>
				<%= profile.country_of_origin %>
				<% end %>
				</strong>
				with
				<strong>
				<% if profile.company_size.blank? %>
					unknown number of employees
				<% else %>
					<%= CompanySize.find(profile.company_size).name rescue nil %>
				<% end %>
				</strong>
			</div>
			<div class="data">
			<span class="item">Sector</span>
			<span class="item">
			<strong>
			<% if profile.sectors.blank? %>
				n/a
			<% else %>
				<% profile.sectors.order_by(:name => "asc").each do |s| %>
					<%= s.name %>
					(<%= profile.subsectors.where(:sector => s).pluck(:name).to_a.join(", ") %>)<br>
				<% end %>
			<% end %>
			</strong>
			</span>
			</div>

		</div>
		
			<%= render partial: "shared/profile/components/links", locals: {profile: profile} %>

	</div><!--/.medium-8-->
</div><!--/.row-->


<div class="row">
	<div class="small-12 columns">
		<%= render partial: "shared/profile/components/gallery", locals: {gallery: @gallery, profile: profile} %>
	</div><!--/.small-12-->
</div><!--/.row-->


<div class="row">
	<div class="small-12 columns">
		<div class="brand-positioning">
			<%= simple_format(profile.brand_positioning) %>
		</div>
	</div><!--/.small-12-->
</div><!--/.row-->


<div class="row">
	<div class="small-12 columns">
		<%= render partial: "shared/profile/components/indicators", locals: {match: profile} %>
	</div><!--/.small-12 -->
</div><!--/.row -->

<div class="row profile-skus">
	
		<% if profile.products.where(current: true).length > 0 %>

			<div class="small-12 columns">
				<div class="profile-section-head"><%= profile.products.where(current: true).length %> CURRENT SKUs</div>
			</div><!--/.small-12-->
			
			<div class="medium-11 medium-centered columns">
			<% profile.products.where(current: true).order_by(:description.desc, :key_benefits.desc).each do |p| %>
				<%= render partial: "shared/collections_view/products", locals: {
					collitem: p
				} %>
			<% end %>
			</div><!--/.medium-11-->

		<% end %>
		<% if profile.products.where(current: false).length > 0 %>

			<div class="small-12 columns">
				<div class="profile-section-head"><%= profile.products.where(current: false).length %> FUTURE SKUs</div>
			</div><!--/.small-12-->

			<div class="medium-11 medium-centered columns">
			<% profile.products.where(current: false).order_by(:description.desc, :key_benefits.desc).each do |p| %>												<%= render partial: "shared/collections_view/products", locals: {
					collitem: p
				} %>
			<% end %>
			</div><!--/.medium-11-->

		<% end %>
	
</div><!--/.row-->

<div id="profile-profile-wrapper">


	<%= render partial: "matches/conversation_start", locals: {profile: profile} %>



	<div class="row collapse">
		<div class="small-12 columns">
	


					<% unless profile.brand_photos.blank? %>

					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									BRAND GALLERY
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">
					
							<div class="galleria-brand-photos">
								<% profile.brand_photos.each do |photo| %>
									<%= link_to photo.photo.url(:large) do %>
										<%= image_tag photo.photo.url(:small) %>
									<% end %>
						    <% end %>
								<% content_for :javascript_foot do %>
									<% javascript_tag do %>
									initializeGallery(".galleria-brand-photos")
									<% end %>
								<% end %>					    
							</div>

						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<br>

					<% end %>

					<% if profile.press_hits.length > 0 %>
					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									PRESS CLIPS
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">

						<ul class="small-block-grid-1 medium-block-grid-3" data-equalizer>
						<% profile.press_hits.order_by(:date.desc).each do |p| %>
							<li><%= render partial: "shared/collections_view/press_hits", locals: {
								collitem: p
							} %></li>
						<% end %>
						</ul>

						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<br>
					<% end %>


					<% if profile.trade_shows.length > 0 %>
					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									TRADE SHOWS
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">

							<ul class="small-block-grid-1 medium-block-grid-3" data-equalizer>
							<% profile.trade_shows.order_by(:date.desc).each do |p| %>
								<li><%= render partial: "shared/collections_view/trade_shows", locals: {
									collitem: p
								} %></li>
							<% end %>
							</ul>
														
						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<br>
					<% end %>


					<% if profile.patents.length > 0 %>
					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									PATENTS
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">
						
						<ul class="small-block-grid-1 medium-block-grid-3" data-equalizer>
						<% profile.patents.order_by(:country.asc, :date.desc).each do |p| %>
							<li><%= render partial: "shared/collections_view/patents", locals: {
								collitem: p
							} %></li>
						<% end %>
						</ul>
														
						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<br>
					<% end %>


					<% if profile.trademarks.length > 0 %>
					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									TRADEMARKS
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">
						
						<ul class="small-block-grid-1 medium-block-grid-3" data-equalizer>
						<% profile.trademarks.order_by(:country.asc, :date.desc).each do |p| %>
							<li><%= render partial: "shared/collections_view/trademarks", locals: {
								collitem: p
							} %></li>
						<% end %>
						</ul>

						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<br>
					<% end %>


					<% if profile.compliances.length > 0 %>
					<div class="profile-container">
						<div class="row">
							<div class="small-12 columns">
								<div class="profile-section-head">
									BUSINESS CERTIFICATIONS
								</div><!--.profile-section-head-->								
							</div><!--/.small-12-->
						</div><!--/.row-->
						<div class="profile-content">

						<ul class="small-block-grid-1 medium-block-grid-3" data-equalizer>
						<% profile.compliances.order_by(:country.asc, :date.desc).each do |p| %>
							<li><%= render partial: "shared/collections_view/compliances", locals: {
								collitem: p
							} %></li>
						<% end %>
						</ul>

						</div><!--.profile-content-->
					</div><!--.profile-container-->
					<% end %>


		</div><!--/.small-11 small-centered-->
	</div><!--/.row-->
</div>
		
<%# set default product photo %>
<% content_for :javascript_head do %>
	<%= javascript_tag do %>
		var profileType = "<%=profile.class.to_s.downcase%>";
		var hasConversation = <%= @messages && @current_user.subscriber? ? "true" : "false" %>;
		var bsPhotos = [
		<% profile.sectors.each do |sector| %>
			'/images/SECTORS_<%= sector.name.gsub(/\s+/, "").gsub(/\//, "").downcase %>.svg',
		<% end %>	
		]
	<% end %>
<% end %>	
<% content_for :javascript_foot do %>
	<%= javascript_tag do %>
		$( document ).ready(function() {
			initFullProfile();
		});		
	<% end %>
<% end %>

